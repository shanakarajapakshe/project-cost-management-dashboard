<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profit Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container-fluid">
        <!-- Header -->
        <header class="bg-primary text-white py-3 mb-4">
            <div class="container">
                <h1 class="mb-0">
                    <svg width="32" height="32" class="me-2" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                        <path d="M2 17l10 5 10-5M2 12l10 5 10-5"></path>
                    </svg>
                    Profit Dashboard
                </h1>
            </div>
        </header>

        <!-- Month/Year Selection Section -->
        <section id="monthYearSection" class="container mb-4">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h4 class="card-title mb-4">Select Month & Year</h4>
                    <div class="row g-3">
                        <div class="col-md-4">
                            <label for="monthSelect" class="form-label">Month</label>
                            <select id="monthSelect" class="form-select">
                                <option value="01">January</option>
                                <option value="02">February</option>
                                <option value="03">March</option>
                                <option value="04">April</option>
                                <option value="05">May</option>
                                <option value="06">June</option>
                                <option value="07">July</option>
                                <option value="08">August</option>
                                <option value="09">September</option>
                                <option value="10">October</option>
                                <option value="11">November</option>
                                <option value="12">December</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label for="yearSelect" class="form-label">Year</label>
                            <select id="yearSelect" class="form-select"></select>
                        </div>
                        <div class="col-md-4 d-flex align-items-end">
                            <button id="loadMonthBtn" class="btn btn-primary w-100">Load Month Data</button>
                        </div>
                    </div>
                    <div id="currentPeriod" class="mt-3 text-muted"></div>
                </div>
            </div>
        </section>

        <!-- Main Content (Hidden until month/year selected) -->
        <div id="mainContent" class="container" style="display: none;">
            
            <!-- Data Entry Form -->
            <section class="mb-4">
                <div class="card shadow-sm">
                    <div class="card-header bg-success text-white">
                        <h5 class="mb-0">Add New Project</h5>
                    </div>
                    <div class="card-body">
                        <form id="projectForm">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="projectName" class="form-label">Project Name *</label>
                                    <input type="text" class="form-control" id="projectName" required>
                                </div>
                                <div class="col-md-3">
                                    <label for="numEngineers" class="form-label">No. of Engineers *</label>
                                    <input type="number" class="form-control" id="numEngineers" min="0" step="1" required>
                                </div>
                                <div class="col-md-3">
                                    <label for="engineerSalary" class="form-label">Engineer Salary/Month *</label>
                                    <input type="number" class="form-control" id="engineerSalary" min="0" step="0.01" required>
                                </div>
                                <div class="col-md-3">
                                    <label for="ceVisitCharge" class="form-label">CE Visit Charge *</label>
                                    <input type="number" class="form-control" id="ceVisitCharge" min="0" step="0.01" required>
                                </div>
                                <div class="col-md-3">
                                    <label for="visitsPerMonth" class="form-label">Visits/Month *</label>
                                    <input type="number" class="form-control" id="visitsPerMonth" min="0" step="1" required>
                                </div>
                                <div class="col-md-3">
                                    <label for="transportCost" class="form-label">Transport Cost/Month *</label>
                                    <input type="number" class="form-control" id="transportCost" min="0" step="0.01" required>
                                </div>
                                <div class="col-md-3">
                                    <label for="clientPayment" class="form-label">Client Payment/Month *</label>
                                    <input type="number" class="form-control" id="clientPayment" min="0" step="0.01" required>
                                </div>
                                <div class="col-md-3">
                                    <label for="overheadAllocation" class="form-label">Overhead Allocation (%) *</label>
                                    <input type="number" class="form-control" id="overheadAllocation" min="0" max="100" step="0.01" required>
                                </div>
                                <div class="col-12">
                                    <button type="submit" class="btn btn-success">
                                        <svg width="16" height="16" class="me-1" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                            <path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"></path>
                                            <polyline points="17 21 17 13 7 13 7 21"></polyline>
                                            <polyline points="7 3 7 8 15 8"></polyline>
                                        </svg>
                                        Save Project
                                    </button>
                                    <button type="button" id="resetFormBtn" class="btn btn-secondary ms-2">Reset</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </section>

            <!-- Dashboard Section -->
            <section class="mb-4">
                <div class="card shadow-sm">
                    <div class="card-header bg-info text-white d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">Dashboard Overview</h5>
                        <div>
                            <button id="printDashboardBtn" class="btn btn-light btn-sm me-2" onclick="uiController.printDashboard()">
                                <svg width="16" height="16" class="me-1" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <polyline points="6 9 6 2 18 2 18 9"></polyline>
                                    <path d="M6 18H4a2 2 0 01-2-2v-5a2 2 0 012-2h16a2 2 0 012 2v5a2 2 0 01-2 2h-2"></path>
                                    <rect x="6" y="14" width="12" height="8"></rect>
                                </svg>
                                Print / PDF
                            </button>
                            <button id="exportExcelBtn" class="btn btn-light btn-sm" onclick="uiController.exportExcel()">
                                <svg width="16" height="16" class="me-1" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"/>
                                </svg>
                                Export to Excel
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <!-- Summary Stats -->
                        <div class="row mb-4">
                            <div class="col-md-3">
                                <div class="stat-card">
                                    <div class="stat-label">Total Projects</div>
                                    <div class="stat-value" id="totalProjects">0</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stat-card">
                                    <div class="stat-label">Total Revenue</div>
                                    <div class="stat-value text-success" id="totalRevenue">$0</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stat-card">
                                    <div class="stat-label">Total Costs</div>
                                    <div class="stat-value text-danger" id="totalCosts">$0</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stat-card">
                                    <div class="stat-label">Net Profit</div>
                                    <div class="stat-value" id="netProfit">$0</div>
                                </div>
                            </div>
                        </div>

                        <!-- Projects Table -->
                        <div class="table-responsive mb-4">
                            <table class="table table-striped table-hover">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Project</th>
                                        <th>Total Cost</th>
                                        <th>Client Payment</th>
                                        <th>Profit</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="projectsTableBody">
                                    <tr>
                                        <td colspan="5" class="text-center text-muted">No projects added yet</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Charts -->
                        <div class="row">
                            <div class="col-md-6 mb-4">
                                <div class="chart-container">
                                    <h6 class="text-center mb-3">Total Cost vs Client Payment</h6>
                                    <canvas id="costPaymentChart"></canvas>
                                </div>
                            </div>
                            <div class="col-md-6 mb-4">
                                <div class="chart-container">
                                    <h6 class="text-center mb-3">Profit per Project</h6>
                                    <canvas id="profitChart"></canvas>
                                </div>
                            </div>
                            <div class="col-md-6 mb-4">
                                <div class="chart-container">
                                    <h6 class="text-center mb-3">Monthly Profit Trend</h6>
                                    <canvas id="trendChart"></canvas>
                                </div>
                            </div>
                            <div class="col-md-6 mb-4">
                                <div class="chart-container">
                                    <h6 class="text-center mb-3">Overhead % vs Profit</h6>
                                    <canvas id="overheadChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <div id="toast" class="toast" role="alert">
            <div class="toast-header">
                <strong class="me-auto">Notification</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
            </div>
            <div class="toast-body" id="toastMessage"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
